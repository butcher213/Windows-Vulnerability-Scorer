# FileZilla scoring module
# included in version 2.3
# get the header file
import configVariables as cv

def scoreFileZilla():
    if cv.FZ_scorefilezilla == True:
        # initialize the points scored, total points, and HTML variables
        totalPoints = 0
        pointsScored = 0
        htmlOutput = ''

        #get the filezilla configs
        serverconfigs = open("C:/Program Files (x86)/FileZilla Server/FileZilla Server.xml", "r+")
        configData = serverconfigs.read()
        serverconfigs.close()
        if cv.FZ_autoban == True:
            totalPoints += 1
            #configData = configData.split("\n")
            autobanLine = configData.split('<Item name="Autoban enable" type="numeric">')
            if autobanLine[1][0] == "1":
                htmlOutput += '<li>Autoban is enabled on FileZilla</li>'
                pointsScored += 1
        if cv.FZ_autoban == True:
            totalPoints += 1
            #find out if ssl (FTP over TLS) is enabled
            SSLLine = configData.split('<Item name="Enable SSL" type="numeric">')

            #find out if SSL is explicit or not (the setting "Disallow plain unencrypted FTP" is checked)
            #explicitSSL = configData.split('<Item name="Force explicit SSL" type="numeric">')

            #if both ssl things are true, then add the points
            if SSLLine[1][0] == 1: 
                htmlOutput += '<li>SSL is enabled on FileZilla</li>'
                pointsScored += 1
    else:
        totalPoints = 0
        pointsScored = 0
        htmlOutput = ''
    return [pointsScored, totalPoints, htmlOutput]
        
