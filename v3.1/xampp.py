import configVariables as cv
def scoreXampp():
    pointsScored = 0
    totalPoints = 0
    htmlOutput = ''
    errors = ''
    try:
        if cv.PHP_scorePHP == True:
            if cv.PHP_safeMode == True:
                totalPoints += 1
            if cv.PHP_displayErrors == True:
                totalPoints += 1
            if cv.PHP_magicQuotes == True:
                totalPoints += 1

            # load the php.ini file
            php = open('C:/xampp/php/php.ini')
            phpdata = php.read().splitlines()
            php.close()
            # loop through php.ini, and remove all the comments for readability
            for line in phpdata:
                try:
                    if ';' in line or line[0] == ';':
                        continue
                    line = line.lower().replace(' ', '')
                    if cv.PHP_safeMode == True and line == 'safe_mode=on':
                        pointsScored += 1
                        htmlOutput += '<li>PHP safe mode has been enabled</li>'
                    if cv.PHP_displayErrors == True and line == 'display_errors=off':
                        pointsScored += 1
                        htmlOutput += '<li>PHP does not display errors</li>'
                    if cv.PHP_magicQuotes == True and line == 'magic_quotes_gpc=off':
                        pointsScored += 1
                        htmlOutput += '<li>PHP magic quotes have been disabled</li>'
                        
                except:
                    a = 0
        if cv.MYSQL_scoreMYSQL == True:
            if cv.MYSQL_remoteAccess == True:
                totalPoints += 1
            mysqllower = []
            # load the my.ini file
            mysql = open('C:/xampp/mysql/bin/my.ini')
            mysqldata = mysql.read().splitlines()
            mysql.close()

            # loop through my.ini
            for line in mysqldata:
                mysqllower.append(line.lower().replace(' ', ''))
            if 'skip-networking' in mysqllower and cv.MYSQL_remoteAccess == True and 'bind-address=127.0.0.1' in mysqllower:
                pointsScored += 1
                htmlOutput += '<li>MySQL remote access has been disabled</li>'
    except:
        errors += 'Some kind of error with Xampp. Make sure that Xampp is actually installled.<br/>'
    return [pointsScored, totalPoints, htmlOutput, errors]




            
